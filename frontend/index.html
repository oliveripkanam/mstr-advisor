<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MSTR Monitor – Live Equation</title>
    <link rel="icon" type="image/png" href="/favicon.png" />
    <link rel="stylesheet" href="styles.css?v=5" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <header class="container">
      <h1>MSTR Monitor</h1>
      <div id="asof" class="muted"></div>
    </header>

    <main class="container">
      <section class="card">
        <canvas id="chart" height="220"></canvas>
      </section>

      <section id="summary" class="card">
        <div class="row">
          <div class="col">
            <div class="label">Action</div>
            <div class="value"><span id="action" class="badge neutral"></span></div>
          </div>
          <div class="col">
            <div class="label">Blended score</div>
            <div id="blended" class="value"></div>
          </div>
          <div class="col">
            <div class="label">Price</div>
            <div id="price" class="value"></div>
          </div>
          <div class="col">
            <div class="label">MA20</div>
            <div id="ma20" class="value"></div>
          </div>
          <div class="col">
            <div class="label">ATR(14)</div>
            <div id="atr" class="value"></div>
          </div>
        </div>
      </section>

      <section id="plan" class="card">
        <h2>Trade Plan</h2>
        <div class="row">
          <div class="col"><span class="label">Entry low</span><span id="entry_low" class="value"></span></div>
          <div class="col"><span class="label">Entry high</span><span id="entry_high" class="value"></span></div>
          <div class="col"><span class="label">Stop</span><span id="stop" class="value"></span></div>
          <div class="col"><span class="label">Target 2R</span><span id="t2r" class="value"></span></div>
          <div class="col"><span class="label">Target 3R</span><span id="t3r" class="value"></span></div>
        </div>
      </section>

      <section id="pred" class="card">
        <h2>Predictions</h2>
        <div class="row">
          <div class="col"><span class="label">Daily close</span><span id="p_d" class="value"></span></div>
          <div class="col"><span class="label">Weekly close</span><span id="p_w" class="value"></span></div>
          <div class="col"><span class="label">Monthly close</span><span id="p_m" class="value"></span></div>
          <div class="col"><span class="label">Bands</span><span id="p_b" class="value"></span></div>
        </div>
      </section>

      <section id="legend" class="card">
        <h2>Legend</h2>
        <div class="legend">
          <div class="item"><span class="swatch" style="background:#4aa3ff"></span> <span>Close</span></div>
          <div class="item"><span class="swatch" style="background:#ffd166"></span> <span>MA20</span></div>
          <div class="item"><span class="swatch" style="background:#06d6a0"></span> <span>MA60</span></div>
        </div>
        <div class="legend-desc">
          <p><b>Close</b>: Daily closing price of MSTR from Yahoo Finance (yfinance). Serves as the raw price series plotted.</p>
          <p><b>MA20</b>: 20–day simple moving average of close. A fast trend baseline that reacts to short‑term shifts; price above a rising MA20 is typically constructive.</p>
          <p><b>MA60</b>: 60–day simple moving average of close. Smoother medium‑term trend gauge; reduces noise relative to MA20 and helps identify regime changes.</p>
        </div>
      </section>

      <section id="equation" class="card">
        <h2>Equation Panel</h2>
        <div id="horizons"></div>
      </section>

      <section id="math" class="card">
        <h2>Mathematical Equation</h2>
        <div id="math_eq" class="eq"></div>
      </section>

      <section id="cadence" class="card">
        <h2>Update Cadence</h2>
        <div class="accordion">
          <details>
            <summary><b>Price (hot.json)</b> – every 1 minute (market hours)</summary>
            <p>Lightweight JSON with the latest trade, change and timestamp. Generated by a tiny job and fetched directly by the page to draw the live price marker. No site rebuilds, costs ~zero.</p>
          </details>
          <details>
            <summary><b>News & sentiment</b> – every 10 minutes (market hours)</summary>
            <p>Polls RSS (Google News + Coindesk), dedupes by URL/title and scores headlines with a simple keyword model. Keeps the feed and the daily bias fresh without hammering the API.</p>
          </details>
          <details>
            <summary><b>Snapshot (scores / contributions)</b> – hourly</summary>
            <p>Recomputes the daily/weekly/monthly scores and the trade plan from the most recent artifacts. Think of it as “refresh the equation panel”. Small payload, safe to run often.</p>
          </details>
          <details>
            <summary><b>OHLCV, technicals, cross‑asset</b> – daily EOD</summary>
            <p>Fetches daily bars for MSTR, BTC, QQQ, VIX and UUP and builds indicators (MA20/MA60, RSI, ATR%, betas, regimes). EOD is enough; intraday bars would add cost for little gain.</p>
          </details>
          <details>
            <summary><b>Recommendation, probs, explain</b> – daily EOD</summary>
            <p>Combines rules + latest model output into the call (“Buy / Hold …”), plus the narrative and what‑changed notes. Runs right after the data build so the site tells a consistent story.</p>
          </details>
          <details>
            <summary><b>ML train & backtests</b> – weekly</summary>
            <p>Retrains the model with walk‑forward validation and regenerates equity/rolling/monthly stats. It’s the heavier job, so we keep it to weekends unless we ship a new idea.</p>
          </details>
        </div>
      </section>
    </main>

    <script src="app.js?v=5"></script>
  </body>
  </html>


